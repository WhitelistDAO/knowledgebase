# Sandwich Attack And Flash Loan

三明治攻击（sandwich attack）和闪电贷攻击（flash loan）都是DeFi里常见的攻击方式，学习这两种攻击方式将加深对DeFi的理解。

## Sandwich Attack

三明治攻击（sandwich attack）是DeFi里流行的抢先交易技术的一种，2018年V神曾在一篇关于Uniswap的文章中谈过它。为了形成一个"三明治"交易，攻击者（掠夺性交易员）会找到一个待处理的受害者交易，然后试图通过前后的交易夹击该受害者。因为区块链公开透明的特性（所有的交易都可以在mempool里被任何人看到），这种攻击经常发生。

三明治攻击通常包含以下过程：

1. 监测出受害者交易
2. 通过提高gas fee抢先受害人交易（购买同一种资产）
3. 受害人在更高的滑点进行了交易
4. 攻击者在受害人交易后发起交易

防范三明治攻击的方式是对交易的细节进行加密，例如使用零知识证明技术 zk-SNARKs。

## Flash Loan

闪电贷最先由借贷协议aave提出，后来在DeFi中得到广泛应用。Flash Loans允许借贷者在不提供任何抵押的情况下借用任何可用的资产金额，只要借贷者将借出的资产和利息在一个区块交易中返回到协议。要进行闪电贷款，借贷者需要构建一个请求闪电贷款的合同。然后，合同将需要执行指示的步骤，并在同一笔交易中偿还贷款+利息和费用。如果借贷者未能在同一个区块中偿还贷款和利息，那么所有的状态和操作都将被回滚，就像这次借贷交易没有发生一样。

闪电贷攻击的方式是攻击者在一个dex中借出资产，然后利用借出资产在不同的dex中通过交易获利，并将借出的资产归还，攻击获得的利润则被攻击者赚取。